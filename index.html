<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Syntax Card Game</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/ohm-js@16.4.0/dist/ohm.js"></script>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <style>
        :root {
            --bg-dark: #1a202c;
            --bg-medium: #2d3748;
            --bg-light: #4a5568;
            --text-light: #e2e8f0;
            --text-dark: #a0aec0;
            --accent: #4fd1c5;
            --accent-dark: #38b2ac;
            --success: #68d391;
            --error: #fc8181;
            --warning: #f6e05e;
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-light);
            margin: 0;
            padding: 2rem;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        #mode-modal-overlay {
            display: flex;
        }

        .modal-content {
            background-color: var(--bg-medium);
            color: white;
            padding: 40px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 450px;
        }
        
        .modal-content h2 {
            margin-top: 0;
            margin-bottom: 2rem;
            font-size: 1.8rem;
        }
        
        .modal-content h3 {
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .modal-content button {
            background-color: var(--accent);
            color: var(--bg-dark);
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease, opacity 0.3s ease;
            font-weight: 600;
            width: 100%;
        }

        .modal-content button:hover:not(:disabled) {
            background-color: var(--accent-dark);
        }

        .modal-content button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background-color: var(--bg-light);
        }
        
        .modal-content button.secondary {
             background-color: var(--bg-light);
             color: var(--text-light);
        }
        .modal-content button.secondary:hover {
             background-color: #5a6b87;
        }

        .modal-content input {
            display: block;
            width: 100%;
            padding: 12px;
            margin-bottom: 1rem;
            border-radius: 5px;
            border: 2px solid var(--bg-light);
            background-color: var(--bg-dark);
            color: var(--text-light);
            font-size: 1rem;
            text-align: center;
        }
        .modal-content input::placeholder {
            color: var(--text-dark);
        }
        .modal-content .button-group {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        #multiplayer-feedback {
            min-height: 24px;
            margin-top: 1rem;
            color: var(--error);
            font-weight: 600;
        }

        #group-code-display {
            margin-top: 1.5rem;
            font-size: 1.1rem;
        }
        #group-code-display strong {
            display: inline-block;
            padding: 0.5rem 1rem;
            background-color: var(--bg-dark);
            border-radius: 5px;
            color: var(--accent);
            letter-spacing: 2px;
            margin-left: 0.5rem;
        }
        
        #waiting-room-player-list {
            list-style: none;
            padding: 0;
            margin: 1.5rem 0;
            text-align: left;
            max-height: 200px;
            overflow-y: auto;
            background-color: var(--bg-dark);
            border-radius: 5px;
            padding: 1rem;
        }
        #waiting-room-player-list li {
            padding: 0.5rem 0.75rem;
            font-weight: 600;
            border-bottom: 1px solid var(--bg-light);
        }
        #waiting-room-player-list li:last-child {
            border-bottom: none;
        }


        #change-level-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: var(--bg-light);
            color: var(--text-light);
            z-index: 10;
        }
        #change-level-btn:hover {
            background-color: #5a6b87;
        }

        #game-container {
            width: 100%;
            max-width: 800px;
            background-color: var(--bg-medium);
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--bg-light);
            display: none; 
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent);
            margin: 0;
        }

        header p {
            color: var(--text-dark);
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }

        #progress-tracker {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-dark);
            font-weight: 600;
            margin-bottom: 1.5rem;
        }

        #progress-bar-container {
            width: 100%;
            background-color: var(--bg-dark);
            border-radius: 99px;
            height: 1rem;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        #progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, var(--accent-dark), var(--accent));
            border-radius: 99px;
            transition: width 0.3s ease-in-out;
        }

        #score-display {
            font-size: 1.2rem;
        }

        #timer {
            position: absolute;
            top: 0;
            left: 0;
            background-color: var(--bg-light);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            font-weight: 700;
        }

        #sentence-tray {
            background-color: var(--bg-dark);
            border: 2px dashed var(--bg-light);
            border-radius: 0.5rem;
            padding: 1rem;
            min-height: 80px;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            align-items: center;
            margin: 1.5rem 0;
            transition: border-color 0.3s;
        }

        #word-pool {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            justify-content: center;
            padding: 1rem;
            background-color: var(--bg-dark);
            border-radius: 0.5rem;
        }

        .word-tile {
            background-color: var(--bg-light);
            color: var(--text-light);
            padding: 0.75rem 1.25rem;
            border-radius: 0.375rem;
            font-weight: 600;
            cursor: grab;
            transition: background-color 0.3s, transform 0.2s;
            user-select: none;
        }

        .word-tile:hover {
            background-color: #5a6b87;
        }
        
        .word-tile.dragging {
            opacity: 0.5;
            transform: scale(1.05);
        }

        #feedback-area {
            text-align: center;
            margin-top: 1.5rem;
            min-height: 2.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .feedback-correct {
            color: var(--success);
        }

        .feedback-incorrect {
            color: var(--error);
        }

        #action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .btn {
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn-primary {
            background-color: var(--accent);
            color: var(--bg-dark);
        }
        .btn-primary:hover {
            background-color: var(--accent-dark);
        }

        .btn-secondary {
            background-color: var(--bg-light);
            color: var(--text-light);
        }
        .btn-secondary:hover {
            background-color: #5a6b87;
        }

        #multiplayer-scoreboard {
            display: none;
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: var(--bg-dark);
            border-radius: 0.5rem;
        }
        #multiplayer-scoreboard h3 {
            margin-top: 0;
            text-align: center;
            color: var(--accent);
        }
        #player-scores {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        #player-scores li {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--bg-light);
        }
        #player-scores li:last-child {
            border-bottom: none;
        }
        #player-scores .player-name {
            font-weight: 600;
        }
         #player-scores .player-score {
            font-weight: 700;
            color: var(--success);
        }

    </style>
</head>
<body>
    <div id="mode-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <h2>Welcome to The Syntax Card Game!</h2>
            <h3>Choose Your Mode</h3>
            <div class="button-group">
                <button id="single-player-mode-btn">Single Player</button>
                <button id="multiplayer-mode-btn">Multiplayer</button>
            </div>
        </div>
    </div>
    
    <div id="player-setup-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <h2>Player Setup</h2>
            <h3>Select Your Proficiency</h3>
            <div class="button-group">
                <button class="proficiency-btn" data-level="beginner">Beginner</button>
                <button class="proficiency-btn" data-level="advanced">Advanced</button>
                <button class="proficiency-btn" data-level="professional">Professional</button>
            </div>
        </div>
    </div>

    <div id="multiplayer-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <h2>Multiplayer Setup</h2>
            <input type="text" id="nickname-input" placeholder="Enter your nickname (max 15 chars)">
            <input type="text" id="group-code-input" placeholder="Enter 3-digit group code">
            <div id="multiplayer-feedback">Connecting to server...</div>
            <div class="button-group">
                <button id="join-group-btn" class="secondary" disabled>Join Group</button>
                <button id="create-group-btn" disabled>Create Group</button>
            </div>
        </div>
    </div>
    
    <div id="waiting-room-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <h2>Waiting Room</h2>
            <p>Share this code with your friends!</p>
            <div id="group-code-display">Group Code: <strong>...</strong></div>
            <h3>Players Joined:</h3>
            <ul id="waiting-room-player-list">
                <!-- Player names will be injected here -->
            </ul>
            <button id="start-game-btn">Start Game</button>
        </div>
    </div>


    <div id="game-container">
        <header>
            <h1 id="game-title">The Syntax Card Game</h1>
            <p id="game-subtitle">Arrange the words to form a correct sentence.</p>
            <div id="timer">Time: 30</div>
        </header>

        <main>
            <div id="progress-tracker">
                <div id="level-indicator">Level: 1/50</div>
                <div id="question-indicator">Question: 1/30</div>
            </div>
            <div id="progress-bar-container">
                <div id="progress-bar"></div>
            </div>

            <div id="sentence-tray" class="droppable"></div>
            <div id="word-pool" class="droppable"></div>

            <div id="feedback-area"></div>

            <div id="action-buttons">
                <button id="reset-btn" class="btn btn-secondary">Reset</button>
                <button id="check-btn" class="btn btn-primary">Check Answer</button>
            </div>

            <div id="multiplayer-scoreboard">
                <h3>Scoreboard</h3>
                <ul id="player-scores">
                </ul>
            </div>
        </main>
    </div>
    
<script type="module">
    // --- STATE MANAGEMENT ---
    const state = {
        gameMode: 'single', // 'single' or 'multi'
        proficiency: 'beginner', // 'beginner', 'advanced', 'professional'
        currentLevel: 1,
        currentQuestion: 1,
        totalLevels: 50,
        totalQuestionsPerLevel: 30,
        score: 0,
        timer: 30,
        timerInterval: null,
        currentSentence: '',
        currentWords: [],
        playerData: { id: null, nickname: '', score: 0 },
        groupCode: null,
        players: [],
        socket: null
    };

    // --- DOM ELEMENTS ---
    const elements = {
        gameContainer: document.getElementById('game-container'),
        levelIndicator: document.getElementById('level-indicator'),
        questionIndicator: document.getElementById('question-indicator'),
        progressBar: document.getElementById('progress-bar'),
        sentenceTray: document.getElementById('sentence-tray'),
        wordPool: document.getElementById('word-pool'),
        feedbackArea: document.getElementById('feedback-area'),
        checkBtn: document.getElementById('check-btn'),
        resetBtn: document.getElementById('reset-btn'),
        timerDisplay: document.getElementById('timer'),
        scoreDisplay: document.getElementById('score-display'),
        modeModal: document.getElementById('mode-modal-overlay'),
        singlePlayerBtn: document.getElementById('single-player-mode-btn'),
        multiplayerBtn: document.getElementById('multiplayer-mode-btn'),
        playerSetupModal: document.getElementById('player-setup-modal-overlay'),
        proficiencyBtns: document.querySelectorAll('.proficiency-btn'),
        multiplayerModal: document.getElementById('multiplayer-modal-overlay'),
        nicknameInput: document.getElementById('nickname-input'),
        groupCodeInput: document.getElementById('group-code-input'),
        joinGroupBtn: document.getElementById('join-group-btn'),
        createGroupBtn: document.getElementById('create-group-btn'),
        multiplayerFeedback: document.getElementById('multiplayer-feedback'),
        waitingRoomModal: document.getElementById('waiting-room-modal-overlay'),
        groupCodeDisplay: document.querySelector('#group-code-display strong'),
        waitingPlayerList: document.getElementById('waiting-room-player-list'),
        startGameBtn: document.getElementById('start-game-btn'),
        multiplayerScoreboard: document.getElementById('multiplayer-scoreboard'),
        playerScoresList: document.getElementById('player-scores')
    };

    // --- OHM.JS GRAMMAR ---
    const grammarSource = `
        SentenceGrammar {
            Sentence = Subject Verb Object Punctuation
            Subject = Noun | Pronoun
            Verb = "runs" | "jumps" | "eats" | "sleeps" | "is" | "are" | "was" | "were" | "has" | "have" | "likes" | "sees"
            Object = Noun | Pronoun
            Noun = "dog" | "cat" | "man" | "woman" | "boy" | "girl" | "apple" | "ball"
            Pronoun = "he" | "she" | "it" | "they" | "we" | "i" | "you"
            Punctuation = "." | "?" | "!"
        }
    `;
    const grammar = ohm.grammar(grammarSource);

    // --- GAME LEVELS ---
    const levels = {
        beginner: [
            { sentence: "the dog runs.", words: ["dog", "the", "runs", "."] },
            { sentence: "she sleeps.", words: ["she", "sleeps", "."] },
        ],
        advanced: [
            { sentence: "the cat sees a ball.", words: ["a", "sees", "cat", "the", "ball", "."] },
        ],
        professional: [
            { sentence: "the quick brown fox jumps over the lazy dog.", words: ["the", "quick", "brown", "fox", "jumps", "over", "the", "lazy", "dog", "."]},
        ]
    };

    // --- SOCKET.IO SETUP ---
    const SERVER_URL = 'https://cognitive-psy-assessment.onrender.com';

    function connectToServer() {
        if (state.socket && state.socket.connected) return;

        // Use default transport negotiation (polling -> websocket) for better reliability
        state.socket = io(SERVER_URL, {
            reconnectionAttempts: 5,
            timeout: 60000, 
        });

        elements.multiplayerFeedback.textContent = 'Connecting to server...';
        elements.joinGroupBtn.disabled = true;
        elements.createGroupBtn.disabled = true;

        state.socket.on('connect', () => {
            console.log('Connected to server with ID:', state.socket.id);
            state.playerData.id = state.socket.id;
            elements.multiplayerFeedback.textContent = '';
            elements.joinGroupBtn.disabled = false;
            elements.createGroupBtn.disabled = false;
        });

        state.socket.on('connect_error', (err) => {
            console.error('Connection failed:', err.message);
            elements.multiplayerFeedback.textContent = `Connection failed. Retrying...`;
        });

        state.socket.on('disconnect', () => {
            console.log('Disconnected from server.');
            elements.multiplayerFeedback.textContent = 'Connection lost. Reconnecting...';
        });

        state.socket.on('groupCreated', ({ groupCode, players }) => {
            state.groupCode = groupCode;
            state.players = players;
            elements.multiplayerModal.style.display = 'none';
            elements.waitingRoomModal.style.display = 'flex';
            elements.groupCodeDisplay.textContent = groupCode;
            updateWaitingRoom(players);
        });

        state.socket.on('joinSuccess', ({ groupCode }) => {
            state.groupCode = groupCode;
            elements.multiplayerModal.style.display = 'none';
            elements.waitingRoomModal.style.display = 'flex';
            elements.groupCodeDisplay.textContent = groupCode;
        });
        
        state.socket.on('joinError', (message) => {
            elements.multiplayerFeedback.textContent = message;
        });

        state.socket.on('updatePlayers', (players) => {
            state.players = players;
            updateWaitingRoom(players);
            if (state.gameMode === 'multi') {
                updateMultiplayerScoreboard(players);
            }
        });

        state.socket.on('gameStarted', () => {
            elements.waitingRoomModal.style.display = 'none';
            startGame();
        });
    }


    // --- UI & EVENT LISTENERS ---
    
    // Mode Selection
    elements.singlePlayerBtn.addEventListener('click', () => {
        state.gameMode = 'single';
        elements.modeModal.style.display = 'none';
        elements.playerSetupModal.style.display = 'flex';
    });
    
    elements.multiplayerBtn.addEventListener('click', () => {
        state.gameMode = 'multi';
        elements.modeModal.style.display = 'none';
        elements.multiplayerModal.style.display = 'flex';
        connectToServer();
    });

    // Proficiency Selection
    elements.proficiencyBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            state.proficiency = btn.dataset.level;
            elements.playerSetupModal.style.display = 'none';
            startGame();
        });
    });

    // Multiplayer Setup
    elements.createGroupBtn.addEventListener('click', () => {
        const nickname = elements.nicknameInput.value;
        if (!nickname.trim()) {
            elements.multiplayerFeedback.textContent = 'Please enter a nickname.';
            return;
        }
        state.playerData.nickname = nickname.slice(0, 15);
        elements.multiplayerFeedback.textContent = '';
        state.socket.emit('createGroup', state.playerData);
    });

    elements.joinGroupBtn.addEventListener('click', () => {
        const nickname = elements.nicknameInput.value;
        const groupCode = elements.groupCodeInput.value;
        if (!nickname.trim() || !groupCode.trim()) {
            elements.multiplayerFeedback.textContent = 'Nickname and group code are required.';
            return;
        }
        state.playerData.nickname = nickname.slice(0, 15);
        elements.multiplayerFeedback.textContent = '';
        state.socket.emit('joinGroup', { playerData: state.playerData, groupCode });
    });

    // Waiting Room
    elements.startGameBtn.addEventListener('click', () => {
        if(state.socket && state.groupCode) {
            state.socket.emit('startGameRequest', state.groupCode);
        }
    });

    // In-Game Actions
    elements.checkBtn.addEventListener('click', checkSentence);
    elements.resetBtn.addEventListener('click', resetWordPositions);

    // --- DRAG AND DROP LOGIC ---
    function initializeDragAndDrop() {
        const draggables = document.querySelectorAll('.word-tile');
        const droppables = document.querySelectorAll('.droppable');

        draggables.forEach(draggable => {
            draggable.addEventListener('dragstart', () => {
                draggable.classList.add('dragging');
            });

            draggable.addEventListener('dragend', () => {
                draggable.classList.remove('dragging');
            });
        });

        droppables.forEach(container => {
            container.addEventListener('dragover', e => {
                e.preventDefault();
                const afterElement = getDragAfterElement(container, e.clientY);
                const draggable = document.querySelector('.dragging');
                if (draggable) {
                   if (afterElement == null) {
                        container.appendChild(draggable);
                    } else {
                        container.insertBefore(draggable, afterElement);
                    }
                }
            });
        });
    }
    
    function getDragAfterElement(container, y) {
        const draggableElements = [...container.querySelectorAll('.word-tile:not(.dragging)')];

        return draggableElements.reduce((closest, child) => {
            const box = child.getBoundingClientRect();
            const offset = y - box.top - box.height / 2;
            if (offset < 0 && offset > closest.offset) {
                return { offset: offset, element: child };
            } else {
                return closest;
            }
        }, { offset: Number.NEGATIVE_INFINITY }).element;
    }


    // --- GAME LOGIC FUNCTIONS ---
    function startGame() {
        elements.gameContainer.style.display = 'block';
        if (state.gameMode === 'multi') {
            elements.multiplayerScoreboard.style.display = 'block';
            updateMultiplayerScoreboard(state.players);
        }
        loadQuestion();
    }
    
    function loadQuestion() {
        // Simple logic for now, will expand to 50 levels / 30 questions
        const levelData = levels[state.proficiency][0]; // Simplified
        state.currentSentence = levelData.sentence;
        state.currentWords = [...levelData.words].sort(() => Math.random() - 0.5);

        renderWords();
        updateUI();
        startTimer();
    }

    function checkSentence() {
        clearInterval(state.timerInterval);
        const sentenceTrayWords = Array.from(elements.sentenceTray.querySelectorAll('.word-tile'));
        const userSentence = sentenceTrayWords.map(tile => tile.textContent).join(' ').toLowerCase();

        // Basic validation for now, replace with Ohm.js
        if (userSentence === state.currentSentence.toLowerCase()) {
            elements.feedbackArea.textContent = "Correct!";
            elements.feedbackArea.className = 'feedback-correct';
            state.score += 10 + state.timer;
            if(state.gameMode === 'multi') {
                state.playerData.score = state.score;
                state.socket.emit('updateScore', state.playerData);
            }
            // Move to next question after a delay
            setTimeout(nextQuestion, 1500);
        } else {
            const match = grammar.match(userSentence);
            let feedback = "Incorrect. Try again!";
            if(match.failed()) {
                const failure = match.message;
                const expected = failure.match(/Expected (.+)/);
                 if (expected) {
                    feedback = `Hint: Something is missing or in the wrong place. The grammar expected ${expected[1].replace(/_/g, ' ')}.`;
                 }
            }
            elements.feedbackArea.textContent = feedback;
            elements.feedbackArea.className = 'feedback-incorrect';
        }
        updateUI();
    }
    
    function nextQuestion() {
        if (state.currentQuestion < state.totalQuestionsPerLevel) {
            state.currentQuestion++;
        } else {
            state.currentQuestion = 1;
            if(state.currentLevel < state.totalLevels) {
                state.currentLevel++;
            } else {
                // Game Over
                elements.feedbackArea.textContent = `Congratulations! You've completed all levels! Final Score: ${state.score}`;
                return;
            }
        }
        loadQuestion();
    }

    function startTimer() {
        state.timer = 30;
        elements.timerDisplay.textContent = `Time: ${state.timer}`;
        clearInterval(state.timerInterval);
        state.timerInterval = setInterval(() => {
            state.timer--;
            elements.timerDisplay.textContent = `Time: ${state.timer}`;
            if (state.timer <= 0) {
                clearInterval(state.timerInterval);
                elements.feedbackArea.textContent = "Time's up!";
                elements.feedbackArea.className = 'feedback-incorrect';
            }
        }, 1000);
    }
    
    function resetWordPositions() {
        // Move all tiles from sentence tray back to word pool
        const sentenceTiles = elements.sentenceTray.querySelectorAll('.word-tile');
        sentenceTiles.forEach(tile => elements.wordPool.appendChild(tile));
    }

    // --- UI UPDATE FUNCTIONS ---
    function renderWords() {
        elements.wordPool.innerHTML = '';
        elements.sentenceTray.innerHTML = '';
        elements.feedbackArea.innerHTML = '';
        state.currentWords.forEach(word => {
            const tile = document.createElement('div');
            tile.className = 'word-tile';
            tile.textContent = word;
            tile.draggable = true;
            elements.wordPool.appendChild(tile);
        });
        initializeDragAndDrop();
    }

    function updateUI() {
        elements.levelIndicator.textContent = `Level: ${state.currentLevel}/${state.totalLevels}`;
        elements.questionIndicator.textContent = `Question: ${state.currentQuestion}/${state.totalQuestionsPerLevel}`;
        const progress = (state.currentQuestion / state.totalQuestionsPerLevel) * 100;
        elements.progressBar.style.width = `${progress}%`;
        // In single player, a score display could be added to the header
    }

    function updateWaitingRoom(players) {
        elements.waitingPlayerList.innerHTML = '';
        players.forEach(player => {
            const li = document.createElement('li');
            li.textContent = player.nickname;
            elements.waitingPlayerList.appendChild(li);
        });
    }

    function updateMultiplayerScoreboard(players) {
        elements.playerScoresList.innerHTML = '';
        const sortedPlayers = [...players].sort((a,b) => b.score - a.score);
        sortedPlayers.forEach(player => {
            const li = document.createElement('li');
            const isCurrentUser = player.id === state.playerData.id;
            li.innerHTML = `
                <span class="player-name">${player.nickname}${isCurrentUser ? ' (You)' : ''}</span>
                <span class="player-score">${player.score}</span>
            `;
            elements.playerScoresList.appendChild(li);
        });
    }

</script>
</body>
</html>